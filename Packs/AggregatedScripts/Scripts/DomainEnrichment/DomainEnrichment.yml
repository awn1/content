args:
- description: A comma-separated list of domains to enrich.
  name: domain_list
  required: true
- name: external_enrichment
  description: Set to true to run reputation commands from external sources. If false (default), the script only queries internal sources as TIM and core-get-domain-analytics-prevalence. Note, providing a value for the brands argument overrides this option.
  auto: PREDEFINED
  predefined:
  - 'true'
  - 'false'
  defaultValue: 'false'
  required: false
- name: verbose
  description: Whether to retrieve a human-readable entry for every command. When set to false, human-readable will only summarize the final result and suppress error entries from commands.
  auto: PREDEFINED
  predefined:
  - 'true'
  - 'false'
  defaultValue: 'false'
  required: false
- name: brands
  description: |-
    A comma-separated list of specific integration brands to use for enrichment, e.g., "VirusTotal,CrowdStrike". If empty, runs against all internal integrations and if external_enrichment is true will run on all external integrations.
  required: false
- name: additional_fields
  description: Whether to return unmapped (secondary) fields to the context output under the "DomainEnrichment.results.AdditionalFields" path.
  auto: PREDEFINED
  predefined:
  - 'true'
  - 'false'
  required: false
comment: This script gathers domain reputation data from multiple integrations and returns a "DomainEnrichment" object with consolidated information to the context output.
commonfields:
  id: domain-enrichment
  version: -1
enabled: false
name: domain-enrichment
outputs:
- contextPath: DomainEnrichment.Data
  description: the domain it self
  type: string
- contextPath: DomainEnrichment.max_score
  description: the max score of all the indicators found
  type: number
- contextPath: DomainEnrichment.max_verdict
  description: the max verdict of all the indicators found
  type: string
- contextPath: DomainEnrichment.results
  description: list of all indicators found for the domain
  type: array
- contextPath: DomainEnrichment.results.Brand
  description: the brand of the indicator
  type: string
- contextPath: DomainEnrichment.results.score
  description: the score of the indicator
  type: number
- contextPath: DomainEnrichment.results.detection_engines
  description: the detection engines of the indicator
  type: number
- contextPath: DomainEnrichment.results.positive_detections
  description: the positive detections of the indicator
  type: number
- contextPath: DomainEnrichment.results.additional_fields
  description: Unmapped (secondary) fields. Only available if the additional_fields argument is set to true.
  type: Object
- contextPath: DBotScore.Indicator
  description: The indicator value.
  type: string
- contextPath: DBotScore.Type
  description: The indicator type.
  type: string
- contextPath: DBotScore.Vendor
  description: Vendor used to calculate the score.
  type: string
- contextPath: DBotScore.Score
  description: The actual score.
  type: number
- contextPath: DBotScore.Reliability
  description: The reliability of the score.
  type: string
- contextPath: Core.AnalyticsPrevalence.Domain.value
  description: Whether the domain is prevalent or not.
  type: Boolean
- contextPath: Core.AnalyticsPrevalence.Domain.data.global_prevalence.value
  description: The global prevalence of the domain.
  type: Number
- contextPath: Core.AnalyticsPrevalence.Domain.data.local_prevalence.value
  description: The local prevalence of the domain.
  type: Number
- contextPath: Core.AnalyticsPrevalence.Domain.data.prevalence.value
  description: The prevalence of the domain.
  type: Number
script: '-'
system: false
tags:
- basescript
timeout: '0'
type: python
subtype: python3
dockerimage: demisto/python3:3.9.8.24399
fromversion: 6.1.0
marketplaces:
- xsoar
- marketplacev2