args:
- description: A comma-separated list of URLs to enrich.
  name: url_list
  required: true
- name: external_enrichment
  description: Set to true to run reputation commands from external sources. If false (default), the script only queries internal sources as TIM and wildfire-get-verdict. Note, providing a value for the brands argument overrides this option.
  auto: PREDEFINED
  predefined:
  - 'true'
  - 'false'
  defaultValue: 'false'
  required: false
- name: verbose
  description: Whether to retrieve a human-readable entry for every command. When set to false, human-readable will only summarize the final result and suppress error entries from commands.
  auto: PREDEFINED
  predefined:
  - 'true'
  - 'false'
  defaultValue: 'false'
  required: false
- name: brands
  description: |-
    A comma-separated list of specific integration brands to use for enrichment, e.g., "VirusTotal,CrowdStrike". If empty, runs against all internal integrations and if external_enrichment is true will run on all external integrations.
  isArray: true
  required: false
- name: additional_fields
  description: Whether to return unmapped (secondary) fields to the context output under the "URL.AdditionalFields" path.
  auto: PREDEFINED
  predefined:
  - 'true'
  - 'false'
  required: false
comment: This script gathers url reputation data from multiple integrations and returns a "URLEnrichment" object with consolidated information to the context output.
commonfields:
  id: url-enrichment
  version: -1
enabled: false
name: url-enrichment
outputs:
- contextPath: URLEnrichment.Data
  description: the url it self
  type: string
- contextPath: URLEnrichment.max_score
  description: the max score of all the indicators found
  type: number
- contextPath: URLEnrichment.max_verdict
  description: the max verdict of all the indicators found
  type: string
- contextPath: URLEnrichment.results
  description: list of all indicators found for the url
  type: array
- contextPath: URLEnrichment.results.Brand
  description: the brand of the indicator
  type: string
- contextPath: URLEnrichment.results.score
  description: the score of the indicator
  type: number
- contextPath: URLEnrichment.results.detection_engines
  description: the detection engines of the indicator
  type: number
- contextPath: URLEnrichment.results.positive_detections
  description: the positive detections of the indicator
  type: number
- contextPath: URLEnrichment.results.additional_fields
  description: Unmapped (secondary) fields. Only available if the additional_fields argument is set to true.
  type: Object
- contextPath: WildFire.Verdicts.VerdictDescription
  description: Description of the verdict.
  type: string
- contextPath: WildFire.Verdicts.AnalysisTime
  description: Verdict analysis time.
  type: Date
- contextPath: WildFire.Verdicts.URL
  description: The URL of the web page.
  type: String
- contextPath: WildFire.Verdicts.Valid
  description: Is the URL valid.
  type: String
- contextPath: WildFire.Verdicts.Verdict
  description: Verdict of the URL.
  type: Number
- contextPath: DBotScore.Indicator
  description: The indicator value.
  type: string
- contextPath: DBotScore.Type
  description: The indicator type.
  type: string
- contextPath: DBotScore.Vendor
  description: Vendor used to calculate the score.
  type: string
- contextPath: DBotScore.Score
  description: The actual score.
  type: number
- contextPath: DBotScore.Reliability
  description: The reliability of the score.
  type: string
script: '-'
system: false
tags:
- basescript
timeout: '0'
type: python
subtype: python3
dockerimage: demisto/python3:3.9.8.24399
fromversion: 6.1.0
marketplaces:
- xsoar
- marketplacev2