id: 4e2904f4-d3ee-41e1-8f77-d747914a9bd2
version: 40
vcShouldKeepItemLegacyProdMachine: false
name: FileEnrichment-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 09c9caf6-dfe1-401a-82c2-47bc7f531230
    type: start
    task:
      id: 09c9caf6-dfe1-401a-82c2-47bc7f531230
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 1825d805-8f32-4923-bbd0-2885b030b209
    type: regular
    task:
      id: 1825d805-8f32-4923-bbd0-2885b030b209
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 7cd7fc8f-1871-4c5f-9e8a-9866a99eedf5
    type: regular
    task:
      id: 7cd7fc8f-1871-4c5f-9e8a-9866a99eedf5
      version: -1
      name: Create SHA256
      description: |
        Creating a hash of a given input, support sha1, sha256, sha512, md5 and blake. Wrapper for https://docs.python.org/3/library/hashlib.html.
      scriptName: CreateHash
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      text:
        simple: FileEnrichmentTest
      type:
        simple: sha256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: d1d94c8b-783c-4030-ab6c-483f0058c940
    type: regular
    task:
      id: d1d94c8b-783c-4030-ab6c-483f0058c940
      version: -1
      name: File Enrichment Internal
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
      - "12"
      - "13"
      - "25"
    scriptarguments:
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: e9356548-99c8-424c-b7d7-291e3c5ed777
    type: condition
    task:
      id: e9356548-99c8-424c-b7d7-291e3c5ed777
      version: -1
      name: |
        Validate Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: WildFire-v2
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 4a4585d2-dfec-4eb0-a177-d6e4391fbb47
    type: regular
    task:
      id: 4a4585d2-dfec-4eb0-a177-d6e4391fbb47
      version: -1
      name: File Enrichment External
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
      - "16"
      - "17"
      - "26"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3)
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: d5b99091-5146-47d9-9e76-d74cdab47c37
    type: regular
    task:
      id: d5b99091-5146-47d9-9e76-d74cdab47c37
      version: -1
      name: Create File Indicator SHA256
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      type:
        simple: File
      value:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: b7ab8950-52ef-4a7d-852b-6106e0df884d
    type: title
    task:
      id: b7ab8950-52ef-4a7d-852b-6106e0df884d
      version: -1
      name: External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 83fc969c-0a3c-41d5-a4d1-1c0bd2231ec2
    type: title
    task:
      id: 83fc969c-0a3c-41d5-a4d1-1c0bd2231ec2
      version: -1
      name: 'Internal Enrichment '
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: df9a77f1-e3d5-4934-8896-a8ad8f89e79e
    type: condition
    task:
      id: df9a77f1-e3d5-4934-8896-a8ad8f89e79e
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: FileEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: FileEnrichment.Brand
                      iscontext: true
                    right:
                      value:
                        simple: TIM
                accessor: SHA256
                transformers:
                - operator: toLowerCase
            iscontext: true
          right:
            value:
              complex:
                root: CreateHash
                transformers:
                - operator: toLowerCase
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: FileEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: FileEnrichment.Brand
                      iscontext: true
                    right:
                      value:
                        simple: WildFire-v2
                accessor: SHA256
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 130caf7a-3dc8-4307-a7fa-bb18dfabb331
    type: condition
    task:
      id: 130caf7a-3dc8-4307-a7fa-bb18dfabb331
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: FileEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: FileEnrichment.Brand
                      iscontext: true
                    right:
                      value:
                        simple: TIM
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              complex:
                root: FileEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: FileEnrichment.Brand
                      iscontext: true
                    right:
                      value:
                        simple: WildFire-v2
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: e3393ca5-7963-4fa8-8fb5-87c4e5280904
    type: regular
    task:
      id: e3393ca5-7963-4fa8-8fb5-87c4e5280904
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CreateHash
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 0ea1b75f-73ab-460b-8966-6c88af730a64
    type: condition
    task:
      id: 0ea1b75f-73ab-460b-8966-6c88af730a64
      version: -1
      name: |
        Validate Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 8b59fca0-fe6b-4a01-8773-18700b485fee
    type: condition
    task:
      id: 8b59fca0-fe6b-4a01-8773-18700b485fee
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.SHA256
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 1acf9e1c-2234-4caf-8274-f52df13ec137
    type: condition
    task:
      id: 1acf9e1c-2234-4caf-8274-f52df13ec137
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 9d5451d4-90b6-4dc6-b284-3693dc0e8c07
    type: title
    task:
      id: 9d5451d4-90b6-4dc6-b284-3693dc0e8c07
      version: -1
      name: Internal and External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: e407d35c-3e7e-4f89-9c89-909bf60bcd35
    type: regular
    task:
      id: e407d35c-3e7e-4f89-9c89-909bf60bcd35
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 66c841e2-5fc8-400d-8529-3dc2441e28e5
    type: regular
    task:
      id: 66c841e2-5fc8-400d-8529-3dc2441e28e5
      version: -1
      name: Create Hash MD5
      description: |
        Creating a hash of a given input, support sha1, sha256, sha512, md5 and blake. Wrapper for https://docs.python.org/3/library/hashlib.html.
      scriptName: CreateHash
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      text:
        simple: FileEnrichmentTest
      type:
        simple: md5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 11839c27-5ac4-452d-937a-04065ca32035
    type: regular
    task:
      id: 11839c27-5ac4-452d-937a-04065ca32035
      version: -1
      name: Create File Indicator MD5
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      type:
        simple: File
      value:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 82e73b9d-c20b-40fd-a5a7-8d2a29ba4774
    type: regular
    task:
      id: 82e73b9d-c20b-40fd-a5a7-8d2a29ba4774
      version: -1
      name: File Enrichment Internal and External
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
      - "28"
      - "29"
      - "30"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3),WildFire-v2
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: bd1529c0-8309-4ea7-aa93-12e62a43cd07
    type: title
    task:
      id: bd1529c0-8309-4ea7-aa93-12e62a43cd07
      version: -1
      name: Case 4 - Some Hash Malformed
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 7f15f82a-9b81-407a-861a-e6e495c43c03
    type: condition
    task:
      id: 7f15f82a-9b81-407a-861a-e6e495c43c03
      version: -1
      name: Validate DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: DBotScore
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 28d42d53-1830-4e54-b1ba-0ac17bd57142
    type: condition
    task:
      id: 28d42d53-1830-4e54-b1ba-0ac17bd57142
      version: -1
      name: Validate DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: f6a157b3-87a8-47af-8763-f4e10d6bd507
    type: condition
    task:
      id: f6a157b3-87a8-47af-8763-f4e10d6bd507
      version: -1
      name: |
        Validate Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 4fecdefa-3e83-410e-8834-85158d53415c
    type: condition
    task:
      id: 4fecdefa-3e83-410e-8834-85158d53415c
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.MD5
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 860ed167-79ed-4b0a-8b88-04e824fc9f26
    type: condition
    task:
      id: 860ed167-79ed-4b0a-8b88-04e824fc9f26
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: d6c022dc-4446-4638-8320-1a45e79d80be
    type: condition
    task:
      id: d6c022dc-4446-4638-8320-1a45e79d80be
      version: -1
      name: Validate DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: d06ed782-a6a8-4191-93df-19f0f30607c5
    type: regular
    task:
      id: d06ed782-a6a8-4191-93df-19f0f30607c5
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "40"
      '#none#':
      - "39"
    scriptarguments:
      additional_fields:
        simple: "true"
      brands:
        simple: dummy
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 43a06817-2a25-4ce2-b525-fb7e2459077e
    type: title
    task:
      id: 43a06817-2a25-4ce2-b525-fb7e2459077e
      version: -1
      name: A Brand Does Not Exist
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 8db0667d-c285-4192-8e73-d0c70e1ec4b0
    type: title
    task:
      id: 8db0667d-c285-4192-8e73-d0c70e1ec4b0
      version: -1
      name: No Arguments
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 3d946b04-570e-4ff4-bbdb-55bbdd0f4077
    type: regular
    task:
      id: 3d946b04-570e-4ff4-bbdb-55bbdd0f4077
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "41"
      '#none#':
      - "39"
    scriptarguments:
      additional_fields:
        simple: "true"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: bf457348-a69d-44b7-9bfa-5dfe12dadf6b
    type: condition
    task:
      id: bf457348-a69d-44b7-9bfa-5dfe12dadf6b
      version: -1
      name: Failure
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              simple: "1"
            iscontext: true
          right:
            value:
              simple: "2"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 797.5,
          "y": 4720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 1d180845-361f-450d-bffb-f70300d712a3
    type: title
    task:
      id: 1d180845-361f-450d-bffb-f70300d712a3
      version: -1
      name: Finish
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 367.5,
          "y": 4725
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 3f15f5fc-739c-46b4-8a9d-999a5b19f3b3
    type: title
    task:
      id: 3f15f5fc-739c-46b4-8a9d-999a5b19f3b3
      version: -1
      name: Malformed Hash
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 4060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 8cacfae0-301f-4c4b-9734-3090073c5bff
    type: regular
    task:
      id: 8cacfae0-301f-4c4b-9734-3090073c5bff
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "34"
      '#none#':
      - "39"
    scriptarguments:
      additional_fields:
        simple: "true"
      file_hash:
        simple: dummy
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 7a5b490a-9c4a-44c4-9e2c-fe31925f4078
    type: title
    task:
      id: 7a5b490a-9c4a-44c4-9e2c-fe31925f4078
      version: -1
      name: Sad Flows
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: fb3732da-7778-4263-85ba-e18d6ee2fb58
    type: regular
    task:
      id: fb3732da-7778-4263-85ba-e18d6ee2fb58
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CreateHash
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 719d077d-f797-46cc-9436-22798a787016
    type: regular
    task:
      id: 719d077d-f797-46cc-9436-22798a787016
      version: -1
      name: File Enrichment Hash Malformed
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
      - "48"
      - "49"
      - "50"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3),WildFire-v2
      file_hash:
        simple: ${CreateHash}, 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: f368335c-3d40-48b2-8c74-b48615ff2c82
    type: condition
    task:
      id: f368335c-3d40-48b2-8c74-b48615ff2c82
      version: -1
      name: |
        Validate Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 25ac5264-d213-4c76-8e9d-7d8cf6f3d4a4
    type: condition
    task:
      id: 25ac5264-d213-4c76-8e9d-7d8cf6f3d4a4
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.MD5
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 12bca415-b3e2-4ca6-8c50-93e0c3f7f533
    type: condition
    task:
      id: 12bca415-b3e2-4ca6-8c50-93e0c3f7f533
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 861be53c-51ac-47f2-888d-feb9fe8c0e1e
    type: condition
    task:
      id: 861be53c-51ac-47f2-888d-feb9fe8c0e1e
      version: -1
      name: Validate DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "32_40_#error#": 0.65
    },
    "paper": {
      "dimensions": {
        "height": 4740,
        "width": 1670,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
quiet: true
