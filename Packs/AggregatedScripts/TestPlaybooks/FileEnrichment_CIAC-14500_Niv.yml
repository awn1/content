id: 4e2904f4-d3ee-41e1-8f77-d747914a9bd2
version: 11
vcShouldKeepItemLegacyProdMachine: false
name: FileEnrichment_CIAC-14500_Niv
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 09c9caf6-dfe1-401a-82c2-47bc7f531230
    type: start
    task:
      id: 09c9caf6-dfe1-401a-82c2-47bc7f531230
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 1825d805-8f32-4923-bbd0-2885b030b209
    type: regular
    task:
      id: 1825d805-8f32-4923-bbd0-2885b030b209
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 22b2cd6f-49c6-4a6b-86c6-892da7f2fb75
    type: regular
    task:
      id: 22b2cd6f-49c6-4a6b-86c6-892da7f2fb75
      version: -1
      name: Create Hash 256
      description: |
        Creating a hash of a given input, support sha1, sha256, sha512, md5 and blake. Wrapper for https://docs.python.org/3/library/hashlib.html.
      scriptName: CreateHash
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      text:
        simple: nivtest
      type:
        simple: sha256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: ed9aafcc-a986-4bd1-aafc-ab40992419d9
    type: regular
    task:
      id: ed9aafcc-a986-4bd1-aafc-ab40992419d9
      version: -1
      name: 'File Enrichment '
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichmenttest
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
      - "12"
      - "13"
    scriptarguments:
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 387c1238-cdd4-42f8-9930-a3607d35b5be
    type: condition
    task:
      id: 387c1238-cdd4-42f8-9930-a3607d35b5be
      version: -1
      name: |
        Verify Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: b1f41a6a-9544-4ca0-b432-0c26d5abec97
    type: regular
    task:
      id: b1f41a6a-9544-4ca0-b432-0c26d5abec97
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
      - "16"
      - "17"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3)
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 56248bc3-cc72-40de-87e5-f979181a99e4
    type: regular
    task:
      id: 56248bc3-cc72-40de-87e5-f979181a99e4
      version: -1
      name: Add to Tim
      description: Retrieve results for a file hash using WildFire.
      script: WildFire-v2|||file
      type: regular
      iscommand: true
      brand: WildFire-v2
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      file:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: b7ab8950-52ef-4a7d-852b-6106e0df884d
    type: title
    task:
      id: b7ab8950-52ef-4a7d-852b-6106e0df884d
      version: -1
      name: External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 83fc969c-0a3c-41d5-a4d1-1c0bd2231ec2
    type: title
    task:
      id: 83fc969c-0a3c-41d5-a4d1-1c0bd2231ec2
      version: -1
      name: 'Internal Enrichment '
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 5c02bafc-58e2-41e3-a83a-8bd797a1d21a
    type: condition
    task:
      id: 5c02bafc-58e2-41e3-a83a-8bd797a1d21a
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.SHA256
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 59b704af-60bc-4e49-8375-af4de5620fd7
    type: condition
    task:
      id: 59b704af-60bc-4e49-8375-af4de5620fd7
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 6e4dcfc3-b74b-43fc-9e34-63969e7363dd
    type: regular
    task:
      id: 6e4dcfc3-b74b-43fc-9e34-63969e7363dd
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CreateHash
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: c90adb0c-9a12-47f3-bc90-bf310359fbf8
    type: condition
    task:
      id: c90adb0c-9a12-47f3-bc90-bf310359fbf8
      version: -1
      name: |
        Verify Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 02d31602-ed8f-4291-b7d4-bb2a924bab6b
    type: condition
    task:
      id: 02d31602-ed8f-4291-b7d4-bb2a924bab6b
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.SHA256
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 1acf9e1c-2234-4caf-8274-f52df13ec137
    type: condition
    task:
      id: 1acf9e1c-2234-4caf-8274-f52df13ec137
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 1e6eceaf-3b91-402e-88d1-d1cf0ad7050b
    type: title
    task:
      id: 1e6eceaf-3b91-402e-88d1-d1cf0ad7050b
      version: -1
      name: Combine Internal and External
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 19323b05-9ae1-4256-8715-cfdb0d6a732a
    type: regular
    task:
      id: 19323b05-9ae1-4256-8715-cfdb0d6a732a
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 638fe72e-52d6-4c2d-a527-503a10e56e66
    type: regular
    task:
      id: 638fe72e-52d6-4c2d-a527-503a10e56e66
      version: -1
      name: Create Hash MD5
      description: |
        Creating a hash of a given input, support sha1, sha256, sha512, md5 and blake. Wrapper for https://docs.python.org/3/library/hashlib.html.
      scriptName: CreateHash
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      text:
        simple: nivtest
      type:
        simple: md5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: e2a3c8ab-7d49-4212-83f6-f52f9c1f0315
    type: regular
    task:
      id: e2a3c8ab-7d49-4212-83f6-f52f9c1f0315
      version: -1
      name: Add to Tim
      description: Checks the file reputation of the specified hash.
      script: VirusTotal (API v3)|||file
      type: regular
      iscommand: true
      brand: VirusTotal (API v3)
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      file:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: d5285e39-c41f-489f-ad41-5eb1b87ecf79
    type: regular
    task:
      id: d5285e39-c41f-489f-ad41-5eb1b87ecf79
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichmenttest
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3),WildFire-v2
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 19beb617-9df0-4309-99e4-960a25cb0714
    type: condition
    task:
      id: 19beb617-9df0-4309-99e4-960a25cb0714
      version: -1
      name: Verify
      description: Prints text to war room (Markdown supported)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    scriptarguments:
      value:
        simple: ${FileEnrichment}
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: FileEnrichment
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: hasLength
          left:
            value:
              simple: DBotScore
            iscontext: true
          right:
            value:
              simple: "3"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 9044ea73-9e81-4539-9aa0-51c44856e25f
    type: title
    task:
      id: 9044ea73-9e81-4539-9aa0-51c44856e25f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2910,
        "width": 1240,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
quiet: true
