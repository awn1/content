id: 4e2904f4-d3ee-41e1-8f77-d747914a9bd2
version: 19
vcShouldKeepItemLegacyProdMachine: false
name: FileEnrichment_CIAC-14500_Niv
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 09c9caf6-dfe1-401a-82c2-47bc7f531230
    type: start
    task:
      id: 09c9caf6-dfe1-401a-82c2-47bc7f531230
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 1825d805-8f32-4923-bbd0-2885b030b209
    type: regular
    task:
      id: 1825d805-8f32-4923-bbd0-2885b030b209
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 1c35cf84-1f6e-42e7-a929-f9cf69f94a14
    type: regular
    task:
      id: 1c35cf84-1f6e-42e7-a929-f9cf69f94a14
      version: -1
      name: Create Hash 256
      description: |
        Creating a hash of a given input, support sha1, sha256, sha512, md5 and blake. Wrapper for https://docs.python.org/3/library/hashlib.html.
      scriptName: CreateHash
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      text:
        simple: FileEnrichmentTest
      type:
        simple: sha256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 02002637-60c8-4af2-9e53-cf879e5b571c
    type: regular
    task:
      id: 02002637-60c8-4af2-9e53-cf879e5b571c
      version: -1
      name: 'File Enrichment '
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
      - "12"
      - "13"
      - "25"
    scriptarguments:
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: b4165155-f0fd-4e63-9dd2-bd78cb680cb6
    type: condition
    task:
      id: b4165155-f0fd-4e63-9dd2-bd78cb680cb6
      version: -1
      name: |
        Verify Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: WildFire-v2
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 835e6d6e-2d43-4324-af2f-872202e00924
    type: regular
    task:
      id: 835e6d6e-2d43-4324-af2f-872202e00924
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
      - "16"
      - "17"
      - "26"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3)
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: c085acc4-455c-4513-bc36-07af15e9acad
    type: regular
    task:
      id: c085acc4-455c-4513-bc36-07af15e9acad
      version: -1
      name: Create Indicator
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      type:
        simple: File
      value:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: b7ab8950-52ef-4a7d-852b-6106e0df884d
    type: title
    task:
      id: b7ab8950-52ef-4a7d-852b-6106e0df884d
      version: -1
      name: External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 83fc969c-0a3c-41d5-a4d1-1c0bd2231ec2
    type: title
    task:
      id: 83fc969c-0a3c-41d5-a4d1-1c0bd2231ec2
      version: -1
      name: 'Internal Enrichment '
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: df9a77f1-e3d5-4934-8896-a8ad8f89e79e
    type: condition
    task:
      id: df9a77f1-e3d5-4934-8896-a8ad8f89e79e
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: FileEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: FileEnrichment.Brand
                      iscontext: true
                    right:
                      value:
                        simple: TIM
                accessor: SHA256
                transformers:
                - operator: toLowerCase
            iscontext: true
          right:
            value:
              complex:
                root: CreateHash
                transformers:
                - operator: toLowerCase
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: FileEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: FileEnrichment.Brand
                      iscontext: true
                    right:
                      value:
                        simple: WildFire-v2
                accessor: SHA256
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 130caf7a-3dc8-4307-a7fa-bb18dfabb331
    type: condition
    task:
      id: 130caf7a-3dc8-4307-a7fa-bb18dfabb331
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: FileEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: FileEnrichment.Brand
                      iscontext: true
                    right:
                      value:
                        simple: TIM
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              complex:
                root: FileEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: FileEnrichment.Brand
                      iscontext: true
                    right:
                      value:
                        simple: WildFire-v2
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: d60eab20-c34a-4c37-a7d5-e47fea3500eb
    type: regular
    task:
      id: d60eab20-c34a-4c37-a7d5-e47fea3500eb
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CreateHash
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 9f256a2e-6d82-415c-a93f-9c7d5c3f0b0e
    type: condition
    task:
      id: 9f256a2e-6d82-415c-a93f-9c7d5c3f0b0e
      version: -1
      name: |
        Verify Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 8b59fca0-fe6b-4a01-8773-18700b485fee
    type: condition
    task:
      id: 8b59fca0-fe6b-4a01-8773-18700b485fee
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.SHA256
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 1acf9e1c-2234-4caf-8274-f52df13ec137
    type: condition
    task:
      id: 1acf9e1c-2234-4caf-8274-f52df13ec137
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 1e6eceaf-3b91-402e-88d1-d1cf0ad7050b
    type: title
    task:
      id: 1e6eceaf-3b91-402e-88d1-d1cf0ad7050b
      version: -1
      name: Combine Internal and External
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 19323b05-9ae1-4256-8715-cfdb0d6a732a
    type: regular
    task:
      id: 19323b05-9ae1-4256-8715-cfdb0d6a732a
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 66c841e2-5fc8-400d-8529-3dc2441e28e5
    type: regular
    task:
      id: 66c841e2-5fc8-400d-8529-3dc2441e28e5
      version: -1
      name: Create Hash MD5
      description: |
        Creating a hash of a given input, support sha1, sha256, sha512, md5 and blake. Wrapper for https://docs.python.org/3/library/hashlib.html.
      scriptName: CreateHash
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      text:
        simple: FileEnrichmentTest
      type:
        simple: md5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: fd6273a2-d74b-49ee-8ba3-119c5381f2f1
    type: regular
    task:
      id: fd6273a2-d74b-49ee-8ba3-119c5381f2f1
      version: -1
      name: Create Indicator MD5
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      type:
        simple: File
      value:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 6f6e62f5-90fa-42fa-99d9-631ca434133f
    type: regular
    task:
      id: 6f6e62f5-90fa-42fa-99d9-631ca434133f
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3),WildFire-v2
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 19beb617-9df0-4309-99e4-960a25cb0714
    type: condition
    task:
      id: 19beb617-9df0-4309-99e4-960a25cb0714
      version: -1
      name: Verify
      description: Prints text to war room (Markdown supported)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    scriptarguments:
      value:
        simple: ${FileEnrichment}
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: FileEnrichment
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: hasLength
          left:
            value:
              simple: DBotScore
            iscontext: true
          right:
            value:
              simple: "3"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 9044ea73-9e81-4539-9aa0-51c44856e25f
    type: title
    task:
      id: 9044ea73-9e81-4539-9aa0-51c44856e25f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 170bbfc3-0314-4f8c-9962-76ae82a0cf3b
    type: condition
    task:
      id: 170bbfc3-0314-4f8c-9962-76ae82a0cf3b
      version: -1
      name: DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: DBotScore
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: dbd3438d-b689-4c05-9024-72f1455ea967
    type: condition
    task:
      id: dbd3438d-b689-4c05-9024-72f1455ea967
      version: -1
      name: DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2910,
        "width": 1670,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
quiet: true
