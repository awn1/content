category: Analytics & SIEM
sectionOrder:
-   Connect
-   Collect
commonfields:
  id: Akamai WAF SIEM
  version: -1
configuration:
-   name: host
    type: 0
    defaultvalue: https://akaa-xxxxxxxxxxxxxxxx-xxxxxxxxxxxxxxxx.luna.akamaiapis.net
    required: true
    display: Server URL (e.g., https://akaa-xxxxxxxxxxxxxxxx-xxxxxxxxxxxxxxxx.luna.akamaiapis.net)
    section: Connect
-   name: clientToken
    type: 4
    required: false
    display: Client token
    section: Connect
    hidden: true
-   name: clienttoken_creds
    type: 9
    required: false
    section: Connect
    displaypassword: Client token
    hiddenusername: true
-   name: accessToken
    type: 4
    required: false
    display: Access token
    section: Connect
    hidden: true
-   name: accesstoken_creds
    type: 9
    required: false
    section: Connect
    displaypassword: Access token
    hiddenusername: true
-   name: clientSecret
    type: 4
    required: false
    display: Client secret
    section: Connect
    hidden: true
-   name: clientsecret_creds
    type: 9
    required: false
    section: Connect
    displaypassword: Client secret
    hiddenusername: true
-   name: configIds
    type: 0
    defaultvalue: '50170'
    required: true
    display: Config IDs to fetch
    section: Collect
-   name: incidentType
    type: 13
    required: false
    display: Incident type
    section: Collect
-   name: fetchTime
    type: 0
    defaultvalue: 1 hours
    required: false
    display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
    section: Collect
-   name: fetchLimit
    type: 0
    additionalinfo: Limit on the number of incidents retrieved in a single fetch. The maximum is 80k.
    defaultvalue: '20'
    required: false
    display: Fetch limit (minimum is 20)
    section: Collect
-   name: page_size
    type: 0
    additionalinfo: The number of events to fetch per request to akamai (multiple requests are made for each fetch). If you're getting aggregated delays, increase the number. The maximum is 80k. Note that if your API has higher ingestion rate, the integration will be able to detect it and immediately starts the next run in order to fetch events quicker.
    defaultvalue: '20000'
    required: false
    display: Akamai Page size
    section: Collect
    advanced: true
    hidden:
    -   xsoar
-   name: isFetch
    type: 8
    required: false
    display: Fetch incidents
    section: Collect
-   name: insecure
    type: 8
    required: false
    display: Trust any certificate (not secure)
    section: Connect
-   name: proxy
    type: 8
    required: false
    display: Use system proxy settings
    section: Connect
-   name: incidentFetchInterval
    type: 19
    defaultvalue: '1'
    required: false
    display: Incidents Fetch Interval
    section: Collect
    hidden:
    -   marketplacev2
-   name: eventFetchInterval
    type: 19
    defaultvalue: '1'
    required: false
    display: Events Fetch Interval
    section: Collect
    advanced: true
    hidden:
    -   xsoar
-   name: isFetchEvents
    type: 8
    required: false
    display: Fetch Events
    section: Collect
    hidden:
    -   xsoar
-   name: should_skip_decode_events
    type: 8
    additionalinfo: Use this parameter to avoid decoding the http message and attack data fields and speed up the ingestion rate.
    required: false
    display: Skip events decoding
    section: Collect
    hidden:
    -   xsoar
description: Use the Akamai WAF SIEM integration to retrieve security events from Akamai Web Application Firewall (WAF) service.
display: Akamai WAF SIEM
name: Akamai WAF SIEM
script:
  commands:
  -   name: akamai-siem-reset-offset
      deprecated: false
      description: Reset the last offset in case the offset is invalid.
  -   name: akamai-siem-get-events
      deprecated: false
      description: Get security events from Akamai WAF.
      arguments:
      -   name: config_ids
          description: 'Unique identifier for each security configuration. To report on more than one configuration, separate the integer identifiers with semicolons (;), for example: 12892;29182;82912.'
          required: true
          deprecated: false
          hidden: false
      -   name: offset
          description: This token denotes the last message. If specified, this operation fetches only security events that have occurred from the offset. This is a required parameter for offset mode and you canâ€™t use it in time-based requests.
          deprecated: false
          hidden: false
      -   name: limit
          description: Defines the maximum number of security events returned per fetch.
          deprecated: false
          hidden: false
      -   name: from_epoch
          description: The start of a specified time range, expressed in Unix epoch seconds.
          deprecated: false
          hidden: false
      -   name: to_epoch
          description: The end of a specified time range, expressed in Unix epoch seconds.
          deprecated: false
          hidden: false
      -   name: time_stamp
          description: Timestamp of events (<number> <time unit>. For example, 12 hours, 7 days.
          deprecated: false
          hidden: false
      outputs:
      -   description: IP address involved in the attack.
          contextPath: Akamai.SIEM.AttackData.clientIP
          type: String
          important: false
      -   description: Unique identifier of the security configuration involved.
          contextPath: Akamai.SIEM.AttackData.ConfigID
          type: String
          important: false
      -   description: Unique identifier of the policy configuration involved.
          contextPath: Akamai.SIEM.AttackData.PolicyID
          type: String
          important: false
      -   description: The policy ID that was triggered.
          contextPath: Akamai.SIEM.AttackData.PolicyID
          type: String
          important: false
      -   description: Geographic ASN location of the IP address involved in the attack.
          contextPath: Akamai.SIEM.AttackData.Geo.Asn
          type: String
          important: false
      -   description: City of the IP address involved in the attack.
          contextPath: Akamai.SIEM.AttackData.Geo.City
          type: String
          important: false
      -   description: Continent of the IP address involved in the attack.
          contextPath: Akamai.SIEM.AttackData.Geo.Continent
          type: String
          important: false
      -   description: Country of the IP address involved in the attack.
          contextPath: Akamai.SIEM.AttackData.Geo.Country
          type: String
          important: false
      -   description: Region code of the IP address involved in the attack.
          contextPath: Akamai.SIEM.AttackData.Geo.RegionCode
          type: String
          important: false
      -   description: HTTP messege size in bytes.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Bytes
          type: Number
          important: false
      -   description: HTTP messege host.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Host
          type: String
          important: false
      -   description: HTTP messege method.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Method
          type: String
          important: false
      -   description: HTTP messege path.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Path
          type: String
          important: false
      -   description: HTTP messege port.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Port
          type: String
          important: false
      -   description: HTTP messege protocol.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Protocol
          type: String
          important: false
      -   description: HTTP messege query.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Query
          type: String
          important: false
      -   description: HTTP messege request headers.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.RequestHeaders
          type: String
          important: false
      -   description: HTTP messege request ID.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.RequestID
          type: String
          important: false
      -   description: HTTP message response headers.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.ResponseHeaders
          type: String
          important: false
      -   description: HTTP messege epoch start time.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Start
          type: Date
          important: false
      -   description: HTTP messege status code.
          contextPath: Akamai.SIEM.AttackData.HttpMessage.Status
          type: Number
          important: false
      -   description: IP address.
          contextPath: IP.Address
          type: String
          important: false
      -   description: 'The autonomous system name for the IP address, for example: "AS8948"."'
          contextPath: IP.ASN
          type: String
          important: false
      -   description: The country in which the IP address is located.
          contextPath: IP.Geo.Country
          type: String
          important: false
  dockerimage: demisto/auth-utils:1.0.0.116931
  isfetch: true
  isfetch:marketplacev2: false
  isfetchevents: true
  isfetchevents:xsoar: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
-   Akamai_WAF_SIEM-Test
fromversion: 5.0.0
toversion: 99.99.99
