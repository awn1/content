commonfields:
  id: 62d7a1a0-b1eb-44de-88af-871a37ed24a7
  version: 23
vcShouldKeepItemLegacyProdMachine: false
name: BlockUserAppAccessWithCAPolicy_copy
script: ''
type: python
tags:
- Azure
- Conditional Access
- Access Control
comment: Checks if a CA policy exists. If yes, adds the user if needed. If no, creates a new CA policy to block access to a specific app for a user.
enabled: true
args:
- name: policy_name
  description: The display name of the Conditional Access policy to check or create. Default value is "Cortex App Block Access - {app_name}".
- name: username
  required: true
  description: The UPN of the user to block.
- name: app_name
  required: true
  description: The name of the app to block access to.
scripttarget: 0
subtype: python3
pswd: ''
runonce: false
dockerimage: demisto/python3:3.12.8.3296088
runas: DBotWeakRole
engineinfo: {}
mainengineinfo: {}
