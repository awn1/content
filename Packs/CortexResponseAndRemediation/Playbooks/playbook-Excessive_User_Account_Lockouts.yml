id: Excessive User Account Lockouts
version: -1
name: Excessive User Account Lockouts
description: |-
  This playbook addresses the following alerts:

  - Excessive user account lockouts
  - Excessive account lockouts on suspicious users
  - Excessive user account lockouts from a suspicious source

  The playbook investigates and responds to excessive user account lockout alerts. It gathers information about the alert, enriches relevant host data, and analyzes event patterns. This analysis helps distinguish between benign lockouts and lockouts caused by brute-force or password spray attacks.

  Playbook Stages:

  Triage:

  - The playbook enriches the alert with details about the lockout events.

  Investigation:

  - Analyzes the lockout event timestamps to detect patterns.
  - Checks for related medium severity brute-force alerts in the incident.
  - Retrieves the Risk Score for the Caller Computer that caused the lockouts.

  Containment:

  - With analyst approval, the playbook can isolate the endpoint (either the Caller Computer or the target host) if it's determined to be a true positive and not a server.

  Requirements:

  - For response actions, the following integration is required: Core - IR.
tags:
- T1110 - Brute Force
- TA0006 - Credential Access
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: a6f8c311-b856-4f69-898f-31f3a2fa1068
    type: start
    task:
      id: a6f8c311-b856-4f69-898f-31f3a2fa1068
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 34a5e2bb-48fc-49e6-8942-973578d1a7a6
    type: regular
    task:
      id: 34a5e2bb-48fc-49e6-8942-973578d1a7a6
      version: -1
      name: Get more information about the lockout events
      description: Returns information about the lockout events, including timestamps and the Caller Computer name.
      script: '|||core-get-cloud-original-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      alert_ids:
        simple: ${alert.id}
      filter_alert_fields:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: b130c4f8-988f-41f5-83b2-c0d560e1749a
    type: title
    task:
      id: b130c4f8-988f-41f5-83b2-c0d560e1749a
      version: -1
      name: Triage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 2a13cd1a-57e6-4dfd-a514-9d9c9779e87d
    type: regular
    task:
      id: 2a13cd1a-57e6-4dfd-a514-9d9c9779e87d
      version: -1
      name: Get endpoint details for the target host
      description: This script gathers endpoint data from multiple integrations and returns an endpoint entity with consolidated information to the context.
      type: regular
      iscommand: false
      brand: ""
      scriptName: get-endpoint-data
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      ignore-outputs:
        simple: "false"
      additional_fields:
        simple: "true"
      brands:
        simple: Cortex Core - IR
      endpoint_hostname:
        simple: ${alert.hostname}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1054
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 35501fc7-5bf8-4a0e-873b-5beec9d343ea
    type: title
    task:
      id: 35501fc7-5bf8-4a0e-873b-5beec9d343ea
      version: -1
      name: Investigation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "31"
      - "53"
      - "8"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: bb054ce8-8cc5-4060-817d-dba6db2ffee1
    type: regular
    task:
      id: bb054ce8-8cc5-4060-817d-dba6db2ffee1
      version: -1
      name: Analyze lockout timestamps
      description: Analyze a list of Unix timestamps in milliseconds, to detect simple patterns of consistency or high frequency. The script can aid in the investigation of multi-event alerts that contain a list of timestamps.
      scriptName: AnalyzeTimestampIntervals
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      timestamps:
        simple: ${Core.OriginalAlert._all_events.event_timestamp}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: f6c847f4-93f0-4cce-89f1-79fd4f983858
    type: title
    task:
      id: f6c847f4-93f0-4cce-89f1-79fd4f983858
      version: -1
      name: Verdict
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "12"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1491
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 8f3e49e5-3f1e-41bf-87ce-085572fb5519
    type: condition
    task:
      id: 8f3e49e5-3f1e-41bf-87ce-085572fb5519
      version: -1
      name: Check alert severity
      description: Checks the severity of the current alert. Different severity variations have different conditions for verdict decision.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "15"
      Low:
      - "13"
    separatecontext: false
    conditions:
    - label: Low
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: alert.severity
            iscontext: true
          right:
            value:
              simple: "1"
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 459,
          "y": 1603
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 8bd9e5e8-d9a9-4d99-8f3d-8a4e8661dd1e
    type: condition
    task:
      id: 8bd9e5e8-d9a9-4d99-8f3d-8a4e8661dd1e
      version: -1
      name: Check verdict - low severity alert
      description: Checks if there are medium severity brute-force alerts in the incident, and if the lockouts seem to be the result of an automated process.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "46"
      True Positive:
      - "61"
    separatecontext: false
    conditions:
    - label: True Positive
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: foundIncidents.id
            iscontext: true
          right:
            value: {}
      - - operator: isTrue
          left:
            value:
              simple: IntervalAnalysis.IsPatternLikelyAutomated
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 144,
          "y": 1752
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 7d622199-eabe-4e9d-ada9-b18026b35868
    type: condition
    task:
      id: 7d622199-eabe-4e9d-ada9-b18026b35868
      version: -1
      name: Check verdict - medium/high severity alert
      description: Checks if the Caller Computer is risky, there are medium severity brute-force alerts in the incident, or if the lockouts seem to be the result of an automated process.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      True Positive:
      - "16"
    separatecontext: false
    conditions:
    - label: True Positive
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.RiskLevel
                      iscontext: true
                    right:
                      value:
                        simple: HIGH
                    ignorecase: true
            iscontext: true
          right:
            value: {}
          ignorecase: true
        - operator: isNotEmpty
          left:
            value:
              simple: foundIncidents.id
            iscontext: true
        - operator: isTrue
          left:
            value:
              simple: IntervalAnalysis.IsPatternLikelyAutomated
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 718,
          "y": 1752
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 0052b546-df3b-4fbd-8c65-9c7cceba5164
    type: title
    task:
      id: 0052b546-df3b-4fbd-8c65-9c7cceba5164
      version: -1
      name: Containment
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "52"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2042
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 377d2f22-5055-4959-910b-55b1b88a020c
    type: regular
    task:
      id: 377d2f22-5055-4959-910b-55b1b88a020c
      version: -1
      name: Isolate the endpoint
      description: Isolates the specified endpoint.
      script: '|||core-isolate-endpoint'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      endpoint_id:
        complex:
          root: IsolationCandidate
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: IsolationCandidate.AdditionalFields.endpoint_type
                iscontext: true
              right:
                value:
                  simple: AGENT_TYPE_SERVER
              ignorecase: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: IsolationCandidate.Hostname
                iscontext: true
          accessor: ID
          transformers:
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 194,
          "y": 2465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: b114af3d-b553-4a33-8652-3b88a888c6f1
    type: condition
    task:
      id: b114af3d-b553-4a33-8652-3b88a888c6f1
      version: -1
      name: Check availability of Caller Computer Name
      description: Checks if the name of the Caller Computer is available in the event, in order to avoid cases where all computers are queried due to an empty filter in the core-get-endpoints command.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      Available:
      - "55"
    separatecontext: false
    conditions:
    - label: Available
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Core.OriginalAlert.event.norm_evtlog_target_domain_name
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: a28e7985-4eef-4e28-8a32-e6d84567fc99
    type: title
    task:
      id: a28e7985-4eef-4e28-8a32-e6d84567fc99
      version: -1
      name: Inconclusive
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1021,
          "y": 2042
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: febe58c2-0341-4b46-a310-039bc34e536d
    type: condition
    task:
      id: febe58c2-0341-4b46-a310-039bc34e536d
      version: -1
      name: Ensure target host is not a server
      description: Retrieves agent information for the host where the lockouts were logged.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      Non-server:
      - "43"
    separatecontext: false
    conditions:
    - label: Non-server
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData
                filters:
                - - operator: isNotEqualString
                    left:
                      value:
                        simple: EndpointData.AdditionalFields.endpoint_type
                      iscontext: true
                    right:
                      value:
                        simple: AGENT_TYPE_SERVER
                    ignorecase: true
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: ac183f0e-fdad-485d-99f9-7ff9234722c6
    type: regular
    task:
      id: ac183f0e-fdad-485d-99f9-7ff9234722c6
      version: -1
      name: Save Caller Computer as target for remediation
      description: Saves the Caller Computer that caused the user lockouts as the remediation target.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      key:
        simple: IsolationCandidate
      value:
        complex:
          root: EndpointData
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: EndpointData.ID
                iscontext: true
          - - operator: isEqualString
              left:
                value:
                  simple: EndpointData.Hostname
                iscontext: true
              right:
                value:
                  simple: Core.OriginalAlert.event.norm_evtlog_target_domain_name
                iscontext: true
              ignorecase: true
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1054
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 5ae582ed-1b72-4fb5-83ec-aa96f92d5e98
    type: regular
    task:
      id: 5ae582ed-1b72-4fb5-83ec-aa96f92d5e98
      version: -1
      name: Save Target Host as target for remediation
      description: Saves the host on which the lockouts occurred as the remediation target.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      key:
        simple: IsolationCandidate
      value:
        complex:
          root: EndpointData
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: EndpointData.ID
                iscontext: true
          - - operator: isEqualString
              left:
                value:
                  simple: EndpointData.Hostname
                iscontext: true
              right:
                value:
                  simple: alert.hostname
                iscontext: true
              ignorecase: true
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1328
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 74e814fa-6f85-4ce7-87c9-0f008d64095f
    type: condition
    task:
      id: 74e814fa-6f85-4ce7-87c9-0f008d64095f
      version: -1
      name: Check Caller Computer risk level
      description: Checks if the Caller Computer that caused the lockouts is risky (if managed).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      Risky:
      - "16"
    separatecontext: false
    conditions:
    - label: Risky
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.RiskLevel
                      iscontext: true
                    right:
                      value:
                        simple: HIGH
                    ignorecase: true
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -85,
          "y": 1893
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: f8c81528-d412-4c77-a0dc-f0a4bdaeff30
    type: regular
    task:
      id: f8c81528-d412-4c77-a0dc-f0a4bdaeff30
      version: -1
      name: Close the alert
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2613
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      closeReason:
        simple: Resolved - True Positive
  "49":
    id: "49"
    taskid: cf7d69ad-8b04-40ea-999c-1b092a1aaa7b
    type: regular
    task:
      id: cf7d69ad-8b04-40ea-999c-1b092a1aaa7b
      version: -1
      name: Manual - host server or unavailable
      description: |-
        Automatic remediation was skipped due to one of the following reasons:
        - The Caller Computer is not managed, and the target host is a server.
        - The Caller Computer and the Target Host are the same, and they are both servers.

        The analyst should take manual remediation steps such as fixing misconfigurations, investigating lockout causes, etc.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 689,
          "y": 2306
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 34d37fc2-f9e0-49a8-9d3f-ceea11475a8f
    type: condition
    task:
      id: 34d37fc2-f9e0-49a8-9d3f-ceea11475a8f
      version: -1
      name: Check remediation preconditions
      description: |-
        Checks if the Caller Computer or host where the lockouts occurred can be remediated.

        The IsolationCandidate key will hold the Caller Computer if it's managed. If not managed or a server, the key will hold the target hostname instead. If the target host is a server, or is the same host as the Caller Computer which happens to be a server, the IsolationCandidate key will be empty, requiring analyst intervention.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "54"
      Host unavailable/server:
      - "49"
    separatecontext: false
    conditions:
    - label: Host unavailable/server
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: IsolationCandidate.Hostname
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2169
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 3979d50a-f78e-4979-8103-27797180092d
    type: regular
    task:
      id: 3979d50a-f78e-4979-8103-27797180092d
      version: -1
      name: Search for suspicious brute force alerts in the incident
      description: Searches for non-low severity alerts with the Brute Force MITRE technique (T1110) in the same alert, which may be related to the excessive lockouts.
      scriptName: SearchAlertsV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      query:
        complex:
          root: alert
          accessor: parentXDRIncident
          transformers:
          - operator: Cut
            args:
              delimiter:
                value:
                  simple: '-'
              fields:
                value:
                  simple: "2"
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'caseid:'
              suffix:
                value:
                  simple: ' and mitreattcktechnique:*T1110* and -severity:LOW and -id:'
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: alert.id
                iscontext: true
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 670,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: ebe50e46-45d0-439e-b042-0d1479eb393f
    type: condition
    task:
      id: ebe50e46-45d0-439e-b042-0d1479eb393f
      version: -1
      name: Manual - decide whether to isolate the endpoint
      description: |+
        Review the following findings and decide whether the host should be isolated:
        ${IsolationCandidate.Hostname}

        Below are the findings of the investigation:


        #### Current Alert Severity:
        `${.=val.alert.severity > 1 ? "Medium or higher" : "Low"}`

        ---

        #### Pattern Likely Automated:
        `${.=val.IntervalAnalysis.IsPatternLikelyAutomated ? "True" : "False"}`

        ---

        #### Related Brute-Force Alerts:
        `${.=val.foundAlerts && val.foundAlerts.id ? "True" : "False"}`

        ---

        #### Risky Caller Computer:
        `${.=val.EndpointData && val.EndpointData.RiskLevel === "HIGH" ? "True" : "False or unavailable"}`

      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "48"
      "Yes":
      - "28"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 259,
          "y": 2306
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body: {}
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 83986255-20ba-4727-8a29-1f9bb04cabcd
    type: regular
    task:
      id: 83986255-20ba-4727-8a29-1f9bb04cabcd
      version: -1
      name: Enrich Caller Computer
      description: This script gathers endpoint data from multiple integrations and returns an endpoint entity with consolidated information to the context.
      scriptName: get-endpoint-data
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      additional_fields:
        simple: "true"
      agent_hostname:
        simple: ${Core.OriginalAlert.event.norm_evtlog_target_domain_name}
      brands:
        simple: Cortex Core - IR
      endpoint_hostname:
        simple: ${Core.OriginalAlert.event.norm_evtlog_target_domain_name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 776
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 2bb1b917-da72-4b80-a17d-0891784a05f2
    type: condition
    task:
      id: 2bb1b917-da72-4b80-a17d-0891784a05f2
      version: -1
      name: Ensure Caller Computer is not a server
      description: Checks whether the Caller Computer is managed and identified is a server.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      Non-server:
      - "41"
    separatecontext: false
    conditions:
    - label: Non-server
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData
                filters:
                - - operator: isNotEqualString
                    left:
                      value:
                        simple: EndpointData.AdditionalFields.endpoint_type
                      iscontext: true
                    right:
                      value:
                        simple: AGENT_TYPE_SERVER
                    ignorecase: true
                accessor: ID
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 18dfae03-d056-41b9-829d-2bb6bf52327d
    type: regular
    task:
      id: 18dfae03-d056-41b9-829d-2bb6bf52327d
      version: -1
      name: Increase alert severity
      description: Optionally increases the alert severity to the new value if it is greater than the existing severity.
      scriptName: IncreaseAlertSeverity
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      severity:
        simple: Medium
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 355,
          "y": 1893
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "13_46_#default#": 0.6,
      "15_16_True Positive": 0.64,
      "15_38_#default#": 0.81,
      "31_4_#default#": 0.16,
      "40_11_#default#": 0.1,
      "46_16_Risky": 0.67,
      "52_49_Host unavailable/server": 0.68,
      "54_48_No": 0.54
    },
    "paper": {
      "dimensions": {
        "height": 2633,
        "width": 1621,
        "x": -170,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
marketplaces: ["marketplacev2", "platform"]
tests:
- no tests
fromversion: 8.8.0
contentitemexportablefields:
  contentitemfields: {}
