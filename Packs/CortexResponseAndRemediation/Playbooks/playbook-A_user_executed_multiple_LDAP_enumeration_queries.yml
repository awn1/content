id: A user executed multiple LDAP enumeration queries
version: -1
name: A user executed multiple LDAP enumeration queries
description: |-
  This playbook addresses the following alerts:

  - A user executed suspicious LDAP enumeration queries

  Playbook Stages:

  Triage:

  - Get additional event information about the LDAP searches executed by the user
  - Ensure that a single client IP exists in the alert
  - Get endpoint information for the client IP
  - Check preconditions for continuing investigation based on the number of suspicious attributes, attack tool queries, and vulnerable certificate templates


  Investigation:

  - Enrich the user that executed the queries
  - Check if the user was created recently
  - Search for additional discovery alerts in the incident
  - Check user groups and roles to determine if the user is unprivileged
  - Check user querying frequency to detect anomalies
  - Get host risk level
  - Search for recent malware alerts on client IP

  Remediation:

  - With analyst approval, disable the user in Active Directory if user-related anomalies are found and the alert is a True Positive.
  - With analyst approval, isolate the endpoint if host-related anomalies are found and the alert is a True Positive.
  - Logoff user from client host if an active session is detected and the alert is a True Positive.

  Requirements:

  For any response action, you need the following integrations:

  - Core - IR
  - Active Directory Query v2.
tags:
- T1087 - Account Discovery
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: b3cdd99f-2cb2-48cf-82a2-83496b582087
    type: start
    task:
      id: b3cdd99f-2cb2-48cf-82a2-83496b582087
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 3b45073c-b0d9-4d5a-852c-df4e74dc0779
    type: title
    task:
      id: 3b45073c-b0d9-4d5a-852c-df4e74dc0779
      version: -1
      name: Triage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
      - "57"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 154
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 71d82ec5-f65a-4efe-81b4-8681d95b3068
    type: regular
    task:
      id: 71d82ec5-f65a-4efe-81b4-8681d95b3068
      version: -1
      name: Search for additional discovery alerts in the incident
      description: Searches for additional alerts in the incident that may further indicate user attempts to enumerate Active Directory.
      scriptName: SearchAlertsV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      extend-context:
        simple: DiscoveryAlertsInIncident=
      fromdate:
        simple: 1 days ago
      ignore-outputs:
        simple: "true"
      query:
        complex:
          root: alert
          accessor: parentXDRIncident
          transformers:
          - operator: Cut
            args:
              delimiter:
                value:
                  simple: '-'
              fields:
                value:
                  simple: "2"
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'caseid:'
              suffix:
                value:
                  simple: ' and (mitreattcktechnique:*T1083* or mitreattcktechnique:*T1087* or mitreattcktechnique:*T1615* or mitreattcktechnique:*T1016*) and -id:'
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: alert.id
                iscontext: true
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1061,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 397aa0fb-bbfe-403b-807b-e1815c8e2bea
    type: regular
    task:
      id: 397aa0fb-bbfe-403b-807b-e1815c8e2bea
      version: -1
      name: Get additional event information
      description: Returns detailed information about the LDAP searches executed by the user.
      script: '|||core-get-cloud-original-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      alert_ids:
        simple: ${alert.id}
      filter_alert_fields:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 301
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: b472c5b7-0999-4706-8562-db460d7f2bd1
    type: regular
    task:
      id: b472c5b7-0999-4706-8562-db460d7f2bd1
      version: -1
      name: Search for recent malware alerts on client IP
      description: Searches for Malware category alerts that occurred in the past day with host IP equal to the client IP of the current alert.
      scriptName: SearchAlertsV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      extend-context:
        simple: MalwareAlertsOnHost=
      fromdate:
        simple: 1 days ago
      ignore-outputs:
        simple: "true"
      query:
        complex:
          root: Core.OriginalAlert.event
          accessor: client
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'hostip:'
              suffix:
                value:
                  simple: ' and categoryname:Malware'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1111,
          "y": 1248
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 6effa91d-38e0-4dfb-8a92-df531a3d6b4e
    type: title
    task:
      id: 6effa91d-38e0-4dfb-8a92-df531a3d6b4e
      version: -1
      name: Investigation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "18"
      - "19"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e7e2c5dc-46a4-466f-a6ef-ec40b094423b
    type: condition
    task:
      id: e7e2c5dc-46a4-466f-a6ef-ec40b094423b
      version: -1
      name: Ensure that a single client IP exists
      description: Ensures that the alert contains only 1 client IP. LDAP enumeration query alerts containing multiple IPs are not supported by the playbook.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Core.OriginalAlert.event.client
            iscontext: true
      - - operator: isNotEqualString
          left:
            value:
              simple: Core.OriginalAlert.event.client
            iscontext: true
          right:
            value:
              simple: 127.0.0.1
          ignorecase: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Core.OriginalAlert.event
                accessor: client
                transformers:
                - operator: RegexExtractAll
                  args:
                    error_if_no_match: {}
                    ignore_case: {}
                    multi_line: {}
                    period_matches_newline: {}
                    regex:
                      value:
                        simple: \.
                    unpack_matches: {}
                - operator: count
            iscontext: true
          right:
            value:
              simple: "3"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 436
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 83697e52-934b-4555-9aa9-b98831769d99
    type: regular
    task:
      id: 83697e52-934b-4555-9aa9-b98831769d99
      version: -1
      name: Get endpoint info for the client IP
      description: This script gathers endpoint data from multiple integrations and returns an endpoint entity with consolidated information to the context.
      type: regular
      iscommand: false
      brand: ""
      scriptName: get-endpoint-data
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      additional_fields:
        simple: "true"
      agent_ip:
        complex:
          root: Core.OriginalAlert.event
          accessor: client
          transformers:
          - operator: uniq
      brands:
        simple: Cortex Core - IR
      endpoint_ip:
        simple: ${Core.OriginalAlert.event.client}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 230,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 88d9bfe6-1065-40e9-a21e-bfbaf17e9be7
    type: regular
    task:
      id: 88d9bfe6-1065-40e9-a21e-bfbaf17e9be7
      version: -1
      name: Enrich user
      description: This script gathers user data from multiple integrations and returns an Account entity with consolidated information to the context.
      scriptName: get-user-data
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
      - "22"
      - "29"
      - "3"
    scriptarguments:
      attributes:
        simple: whenCreated
      user_name:
        simple: ${UsernameWithoutPrefix}
      additional_fields:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 153,
          "y": 1102
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f8117cd9-1e84-4309-97b2-4fb9cbc54978
    type: title
    task:
      id: f8117cd9-1e84-4309-97b2-4fb9cbc54978
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "17"
      - "49"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 443,
          "y": 2068
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 0caeb27b-423f-45e3-8971-fa08e763f2d5
    type: condition
    task:
      id: 0caeb27b-423f-45e3-8971-fa08e763f2d5
      version: -1
      name: Check preconditions for continuing investigation
      description: Checks if investigation and remediation can be done based on pre-conditions signifying high probability of a true positive alert and inherently malicious behavior.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "50"
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThan
          left:
            value:
              simple: Core.OriginalAlert.stateful_raw_data.count_distinct_search_filter_suspicious_attributes
            iscontext: true
          right:
            value:
              simple: "15"
        - operator: greaterThan
          left:
            value:
              simple: Core.OriginalAlert.stateful_raw_data.count_distinct_search_filter_attack_tool_queries_reliable_signature
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: greaterThan
          left:
            value:
              simple: Core.OriginalAlert.stateful_raw_data.count_distinct_search_filter_vulnerable_certificate_template
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: lessThan
          left:
            value:
              simple: Core.OriginalAlert.stateful_raw_data.visited_to_returned_ratio
            iscontext: true
          right:
            value:
              simple: "0.1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 688
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 714c7fea-af14-4f23-b2cf-9db8179b200a
    type: title
    task:
      id: 714c7fea-af14-4f23-b2cf-9db8179b200a
      version: -1
      name: Skip / Inconclusive
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1946,
          "y": 2990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 8f70c85b-5ef3-4fee-8d9a-7ca33697047a
    type: condition
    task:
      id: 8f70c85b-5ef3-4fee-8d9a-7ca33697047a
      version: -1
      name: Check host analysis results
      description: Checks whether any host-related anomalies were found in the investigation (the host is risky or malware alerts occurred on the host in the past 1 day).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "51"
      Remediate:
      - "66"
    separatecontext: false
    conditions:
    - label: Remediate
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareAlertsOnHost
            iscontext: true
          right:
            value: {}
        - operator: isTrue
          left:
            value:
              simple: HostIsRisky
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 707,
          "y": 2198
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: cbef50e1-da3d-48ca-8e11-ea9882cd7780
    type: title
    task:
      id: cbef50e1-da3d-48ca-8e11-ea9882cd7780
      version: -1
      name: User Investigation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "12"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 153,
          "y": 986
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 5630dcc4-a789-44fd-8886-1c893f868719
    type: title
    task:
      id: 5630dcc4-a789-44fd-8886-1c893f868719
      version: -1
      name: Host Investigation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "63"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 700,
          "y": 986
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 778e431e-ce22-471f-87b3-94c1097cc9df
    type: condition
    task:
      id: 778e431e-ce22-471f-87b3-94c1097cc9df
      version: -1
      name: Check user LDAP querying frequency
      description: Checks if the user executes LDAP queries on a regular basis from one or from multiple hosts, daily.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "59"
      Anomaly:
      - "21"
    separatecontext: false
    conditions:
    - label: Anomaly
      condition:
      - - operator: lessThan
          left:
            value:
              simple: Core.OriginalAlert.stateful_raw_data.actor_user_over_actor_user_ldap_query_count_distinct_search_filter_multiple_days_seen_count
            iscontext: true
          right:
            value:
              simple: "20"
        - operator: lessThan
          left:
            value:
              simple: Core.OriginalAlert.stateful_raw_data.actor_user_over_actor_user_ldap_query_count_distinct_search_filter_multiple_clients_multiple_days
            iscontext: true
          right:
            value:
              simple: "5"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -257,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 75c00eb7-57a6-479b-8116-e1b3036785ab
    type: regular
    task:
      id: 75c00eb7-57a6-479b-8116-e1b3036785ab
      version: -1
      name: Save result - User does not perform LDAP queries regularly
      description: Saves a context key indicating the user doesn't regularly execute LDAP queries (from one or more hosts).
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      key:
        simple: UserDoesNotRegularlyQuery
      value:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -257,
          "y": 1388
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 61a2266c-04ea-4a18-a314-7a27880baf0b
    type: condition
    task:
      id: 61a2266c-04ea-4a18-a314-7a27880baf0b
      version: -1
      name: Check if user creation date exists
      description: Checks if the date and time of when the user was created is available.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "59"
      Exists:
      - "24"
    separatecontext: false
    conditions:
    - label: Exists
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: UserData.AdditionalFields.whenCreated
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 153,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 4ee9d99d-44ae-441f-b257-50d808ea713f
    type: regular
    task:
      id: 4ee9d99d-44ae-441f-b257-50d808ea713f
      version: -1
      name: Convert user creation date to epoch
      description: Converts the user creation date to epoch to find relative time of creation.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      key:
        simple: UserCreationDateInEpoch
      value:
        complex:
          root: UserData.AdditionalFields
          accessor: whenCreated
          transformers:
          - operator: toUnix
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 153,
          "y": 1388
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: dd6b9a68-e648-4e1b-9dad-53a52eb165d3
    type: condition
    task:
      id: dd6b9a68-e648-4e1b-9dad-53a52eb165d3
      version: -1
      name: Check if user was created recently
      description: Checks if the user's creation date in AD happened 24 hours or less since the time that this alert occurred.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "59"
      Anomaly:
      - "28"
    separatecontext: false
    conditions:
    - label: Anomaly
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: Core.OriginalAlert
                accessor: alert_generated_time
                transformers:
                - operator: toUnix
                - operator: subtraction
                  args:
                    by:
                      value:
                        simple: UserCreationDateInEpoch
                      iscontext: true
            iscontext: true
          right:
            value:
              simple: "86400"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 153,
          "y": 1521
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 0c17e758-0700-4d96-8fb9-e9e4a4f32253
    type: regular
    task:
      id: 0c17e758-0700-4d96-8fb9-e9e4a4f32253
      version: -1
      name: Save result - User does not perform LDAP queries regularly
      description: Saves a context key indicating the user was created recently.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      key:
        simple: UserCreatedLast24Hours
      value:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 153,
          "y": 1659
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 69dba99e-8a2b-409f-ab66-79e83e12bd29
    type: condition
    task:
      id: 69dba99e-8a2b-409f-ab66-79e83e12bd29
      version: -1
      name: Check user groups and roles
      description: Checks if the user is part of built-in privileged Active Directory groups.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "59"
      Anomaly:
      - "31"
    separatecontext: false
    conditions:
    - label: Anomaly
      condition:
      - - operator: isEmpty
          left:
            value:
              complex:
                root: UserData.AdditionalFields.memberOf
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: UserData.AdditionalFields.memberOf
                      iscontext: true
                    right:
                      value:
                        simple: CN=Domain Admins,
                    ignorecase: true
                  - operator: containsGeneral
                    left:
                      value:
                        simple: UserData.AdditionalFields.memberOf
                      iscontext: true
                    right:
                      value:
                        simple: CN=Enterprise Admins
                    ignorecase: true
                  - operator: containsGeneral
                    left:
                      value:
                        simple: UserData.AdditionalFields.memberOf
                      iscontext: true
                    right:
                      value:
                        simple: CN=Schema Admins
                    ignorecase: true
                  - operator: containsGeneral
                    left:
                      value:
                        simple: UserData.AdditionalFields.memberOf
                      iscontext: true
                    right:
                      value:
                        simple: CN=Administrators
                    ignorecase: true
                  - operator: containsGeneral
                    left:
                      value:
                        simple: UserData.AdditionalFields.memberOf
                      iscontext: true
                    right:
                      value:
                        simple: CN=Account Operators
                    ignorecase: true
                  - operator: containsGeneral
                    left:
                      value:
                        simple: UserData.AdditionalFields.memberOf
                      iscontext: true
                    right:
                      value:
                        simple: CN=Backup Operators
                    ignorecase: true
            iscontext: true
          right:
            value: {}
      - - operator: isFalse
          left:
            value:
              simple: Core.OriginalAlert.stateful_raw_data.is_ldap_actor_user_service_account
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: Core.OriginalAlert.stateful_raw_data.is_ldap_actor_user_it_user
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -659,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 4132aec2-37d9-44ce-84b0-7ca2ceb5e7d7
    type: regular
    task:
      id: 4132aec2-37d9-44ce-84b0-7ca2ceb5e7d7
      version: -1
      name: Save result - user is unprivileged
      description: Saves a context key indicating the user does not belong to default privileged AD groups.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      key:
        simple: UserIsUnprivileged
      value:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -659,
          "y": 1388
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: d480b097-79f8-4ca1-830d-fbddf57a0b30
    type: condition
    task:
      id: d480b097-79f8-4ca1-830d-fbddf57a0b30
      version: -1
      name: Check host risk level
      description: Checks if the client host's risk level is high.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "59"
      Anomaly:
      - "37"
    separatecontext: false
    conditions:
    - label: Anomaly
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData.RiskLevel
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.RiskLevel
                      iscontext: true
                    right:
                      value:
                        simple: HIGH
                    ignorecase: true
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 700,
          "y": 1248
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 69f4f4c5-9123-4058-8230-f35cc881ca48
    type: regular
    task:
      id: 69f4f4c5-9123-4058-8230-f35cc881ca48
      version: -1
      name: Save risk result
      description: Saves a context key indicating that the client host's risk level is high.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      key:
        simple: HostIsRisky
      value:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 707,
          "y": 1388
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: f21c6a71-46c5-4549-96d7-5186254fb95f
    type: regular
    task:
      id: f21c6a71-46c5-4549-96d7-5186254fb95f
      version: -1
      name: Logoff user from client host
      description: |-
        Logs off the user by using the logoff command for the active user session's ID.
        Note: the regex relies on the fact that interactively logged in users will have an active "console" session in Windows machines.
      script: '|||core-run-script-execute-commands'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      command_type:
        simple: powershell
      commands:
        complex:
          root: Core.ScriptResult.results.executed_command.command_output
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: Core.ScriptResult.results.executed_command.command_output
                iscontext: true
              right:
                value:
                  simple: UsernameWithoutPrefix
                iscontext: true
              ignorecase: true
          - - operator: containsGeneral
              left:
                value:
                  simple: Core.ScriptResult.results.executed_command.command_output
                iscontext: true
              right:
                value:
                  simple: Active
              ignorecase: true
          transformers:
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (?<=\bconsole\s+)\d+
              unpack_matches: {}
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'logoff '
              suffix: {}
      endpoint_ids:
        complex:
          root: EndpointData
          accessor: ID
          transformers:
          - operator: uniq
      is_raw_command:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1509,
          "y": 2841
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: a05f00a4-9458-4c4a-acfd-2d4ff2482455
    type: regular
    task:
      id: a05f00a4-9458-4c4a-acfd-2d4ff2482455
      version: -1
      name: Isolate the endpoint
      description: Isolates the client host machine where the LDAP queries were executed.
      script: '|||core-isolate-endpoint'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      endpoint_id:
        complex:
          root: EndpointData
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: EndpointData.ID
                iscontext: true
              right:
                value:
                  simple: alert.agentid
                iscontext: true
              ignorecase: true
          - - operator: isNotEqualString
              left:
                value:
                  simple: EndpointData.AdditionalFields.endpoint_type
                iscontext: true
              right:
                value:
                  simple: AGENT_TYPE_SERVER
              ignorecase: true
          - - operator: isEqualString
              left:
                value:
                  simple: EndpointData.AdditionalFields.os_type
                iscontext: true
              right:
                value:
                  simple: AGENT_OS_WINDOWS
              ignorecase: true
          accessor: ID
          transformers:
          - operator: uniq
      suppress_disconnected_endpoint_error:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 824,
          "y": 2707
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 66343f41-b9f9-4d30-ada4-c879144b0f61
    type: condition
    task:
      id: 66343f41-b9f9-4d30-ada4-c879144b0f61
      version: -1
      name: Manual - decide whether to isolate the endpoint
      description: |
        Review the following findings and decide whether the host should be isolated:

        ${EndpointData.Hostname}

        Below are the findings of the investigation:

        ---

        #### Malware Alerts on Host:
        `${.=val.MalwareAlertsOnHost && val.MalwareAlertsOnHost.length > 0 ? "True" : "False"}`

        ---

        #### Host is Risky:
        `${.=val.HostIsRisky ? "True" : "False"}`
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Do not isolate:
      - "42"
      Isolate:
      - "39"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 824,
          "y": 2577
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body: {}
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - Isolate
      - Do not isolate
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: e95328f6-94c8-443b-84a0-0118c0aa0a6a
    type: condition
    task:
      id: e95328f6-94c8-443b-84a0-0118c0aa0a6a
      version: -1
      name: Manual - decide whether to disable the user
      description: |
        Review the following findings and decide whether you want to disable the user.

        Username: ${UsernameWithoutPrefix}


        Below are the findings of the investigation:

        ---

        #### User Created Recently:
        `${.=val.UserCreatedLast24Hours ? "True" : "False"}`

        ---

        #### Related Discovery Alerts:
        `${.=val.DiscoveryAlertsInAlert && Object.keys(val.DiscoveryAlertsInAlert).length > 0 ? "True" : "False"}`

        ---

        #### User is Unprivileged:
        `${.=val.UserIsUnprivileged ? "True" : "False"}`

        ---

        #### User Rarely Executes Queries:
        `${.=val.UserDoesNotRegularlyQuery ? "True" : "False"}`
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Disable:
      - "43"
      Do not disable:
      - "42"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -64,
          "y": 2322
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body: {}
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - Disable
      - Do not disable
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: e9c0ee59-dda3-466c-83f7-6a20e7f21c6c
    type: regular
    task:
      id: e9c0ee59-dda3-466c-83f7-6a20e7f21c6c
      version: -1
      name: Close the alert
      description: Closes the current alert.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    scriptarguments:
      id:
        simple: ${alert.id}
      closeReason:
        simple: Resolved - True Positive
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 437,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: ac3975a5-bffc-42a7-969e-45f08037a7cc
    type: regular
    task:
      id: ac3975a5-bffc-42a7-969e-45f08037a7cc
      version: -1
      name: Disable user in AD
      description: This script disables users for multiple services.
      type: regular
      iscommand: false
      brand: ""
      scriptName: disable-user
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      user_name:
        simple: ${UsernameWithoutPrefix}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -64,
          "y": 2487
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 904e0927-8a4d-4289-8031-e7efbb6c5c30
    type: condition
    task:
      id: 904e0927-8a4d-4289-8031-e7efbb6c5c30
      version: -1
      name: Check user analysis results
      description: Checks whether any user-related anomalies were found in the investigation.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "42"
      Remediate:
      - "41"
    separatecontext: false
    conditions:
    - label: Remediate
      condition:
      - - operator: isTrue
          left:
            value:
              simple: UserCreatedLast24Hours
            iscontext: true
          right:
            value: {}
        - operator: isTrue
          left:
            value:
              simple: UserDoesNotRegularlyQuery
            iscontext: true
        - operator: isTrue
          left:
            value:
              simple: UserIsUnprivileged
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: DiscoveryAlertsInIncident
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 169,
          "y": 2198
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: fb134545-e8fb-432f-8194-8a901d99a119
    type: title
    task:
      id: fb134545-e8fb-432f-8194-8a901d99a119
      version: -1
      name: Insufficient evidence for remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1946,
          "y": 1946
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 4b2cd127-b366-4862-a484-75c111e49695
    type: regular
    task:
      id: 4b2cd127-b366-4862-a484-75c111e49695
      version: -1
      name: Manually remediate server / DC / non-Windows machine
      description: "The following host is a domain controller, a server, or not a Windows machine. This means automatic remediation cannot be executed. \n\nPlease review the information below and manually remediate the alert.\nEndpoint name: ${EndpointData.Hostname}\n\nFindings of the investigation:\n\n---\n\n#### Malware Alerts on Host:\n`${.=val.MalwareAlertsOnHost && val.MalwareAlertsOnHost.length > 0 ? \"True\" : \"False\"}`\n\n---\n\n#### Host is Risky:\n`${.=val.HostIsRisky ? \"True\" : \"False\"}`\n"
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 437,
          "y": 2577
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 1bcf7db0-d8de-4dae-947c-15085e3a8e59
    type: regular
    task:
      id: 1bcf7db0-d8de-4dae-947c-15085e3a8e59
      version: -1
      name: Execute get user sessions
      description: Run a shell command on a specific endpoint and return its result.
      script: '|||core-execute-command'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      endpoint_ids:
        complex:
          root: EndpointData
          accessor: ID
          transformers:
          - operator: uniq
      is_raw_command:
        simple: "true"
      command:
        simple: quser ${UsernameWithoutPrefix}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1294,
          "y": 2577
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 03b70d26-3aba-4bb7-b6ce-9a7e3eded14a
    type: condition
    task:
      id: 03b70d26-3aba-4bb7-b6ce-9a7e3eded14a
      version: -1
      name: Check for active session of the user
      description: Checks whether the execution results indicate an active session for the user, confirming the user is currently logged in.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "42"
      Active:
      - "38"
    separatecontext: false
    conditions:
    - label: Active
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Core.ScriptResult.results.executed_command.command_output
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: Core.ScriptResult.results.executed_command.command_output
                      iscontext: true
                    right:
                      value:
                        simple: Active
                    ignorecase: true
                - - operator: containsGeneral
                    left:
                      value:
                        simple: Core.ScriptResult.results.executed_command.command_output
                      iscontext: true
                    right:
                      value:
                        simple: UsernameWithoutPrefix
                      iscontext: true
                    ignorecase: true
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1294,
          "y": 2707
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 699a3c31-10f1-431d-8287-6e5d296cd319
    type: regular
    task:
      id: 699a3c31-10f1-431d-8287-6e5d296cd319
      version: -1
      name: Save username without domain prefix
      description: Saves the username without the domain prefix.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      key:
        simple: UsernameWithoutPrefix
      value:
        complex:
          root: alert
          accessor: username
          transformers:
          - operator: LastArrayElement
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (?<=\\)[^\\]+$
              unpack_matches: {}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 880,
          "y": 301
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: b639c2e0-60f3-4e1d-8930-959c4ff881aa
    type: condition
    task:
      id: b639c2e0-60f3-4e1d-8930-959c4ff881aa
      version: -1
      name: Check for any suspicious evidence
      description: ' '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "50"
      "Yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "Yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareAlertsOnHost
            iscontext: true
          right:
            value: {}
        - operator: isTrue
          left:
            value:
              simple: HostIsRisky
            iscontext: true
        - operator: isTrue
          left:
            value:
              simple: UserCreatedLast24Hours
            iscontext: true
        - operator: isTrue
          left:
            value:
              simple: UserDoesNotRegularlyQuery
            iscontext: true
        - operator: isTrue
          left:
            value:
              simple: UserIsUnprivileged
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: DiscoveryAlertsInIncident
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 443,
          "y": 1812
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 609d0e22-165a-4a7b-b35e-5d3d4c3dfc8e
    type: regular
    task:
      id: 609d0e22-165a-4a7b-b35e-5d3d4c3dfc8e
      version: -1
      name: Increase alert severity
      description: Optionally increases the alert severity to the new value if it is greater than the existing severity.
      scriptName: IncreaseAlertSeverity
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      severity:
        simple: Medium
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 443,
          "y": 1941
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: db529abe-aeb1-4eae-a03d-ef2a6d5349b2
    type: title
    task:
      id: db529abe-aeb1-4eae-a03d-ef2a6d5349b2
      version: -1
      name: User Logoff
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1294,
          "y": 2465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 3b69c7bc-4fe3-4483-91bc-041e6a678c3f
    type: title
    task:
      id: 3b69c7bc-4fe3-4483-91bc-041e6a678c3f
      version: -1
      name: Host Isolation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "40"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 824,
          "y": 2465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 4285d844-4f2b-4a35-a948-24da654259e0
    type: condition
    task:
      id: 4285d844-4f2b-4a35-a948-24da654259e0
      version: -1
      name: Check client is not a server
      description: Ensures that the client that executed the LDAP queries is not a server or the domain controller.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "59"
      Non-Server:
      - "5"
      - "35"
    separatecontext: false
    conditions:
    - label: Non-Server
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData
                filters:
                - - operator: isNotEqualString
                    left:
                      value:
                        simple: EndpointData.ID
                      iscontext: true
                    right:
                      value:
                        simple: alert.agentid
                      iscontext: true
                    ignorecase: true
                - - operator: isNotEqualString
                    left:
                      value:
                        simple: EndpointData.AdditionalFields.endpoint_type
                      iscontext: true
                    right:
                      value:
                        simple: AGENT_TYPE_SERVER
                    ignorecase: true
                accessor: ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEqualString
          left:
            value:
              simple: Core.OriginalAlert.event.client
            iscontext: true
          right:
            value:
              simple: 127.0.0.1
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 700,
          "y": 1114
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 1e9aef53-923f-4538-b5d3-f14769069c91
    type: condition
    task:
      id: 1e9aef53-923f-4538-b5d3-f14769069c91
      version: -1
      name: Check that client OS is Windows and client role is not Server
      description: Ensures that the client is not a server or domain controller and is running the Windows operating system, which is necessary for automatic remediation.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "51"
      Non-Server:
      - "61"
      - "62"
    separatecontext: false
    conditions:
    - label: Non-Server
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData
                filters:
                - - operator: isNotEqualString
                    left:
                      value:
                        simple: EndpointData.ID
                      iscontext: true
                    right:
                      value:
                        simple: alert.agentid
                      iscontext: true
                    ignorecase: true
                - - operator: isNotEqualString
                    left:
                      value:
                        simple: EndpointData.AdditionalFields.endpoint_type
                      iscontext: true
                    right:
                      value:
                        simple: AGENT_TYPE_SERVER
                    ignorecase: true
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.AdditionalFields.os_type
                      iscontext: true
                    right:
                      value:
                        simple: AGENT_OS_WINDOWS
                    ignorecase: true
                accessor: ID
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 707,
          "y": 2322
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "14_50_#default#": 0.15,
      "14_6_yes": 0.49,
      "17_51_#default#": 0.31,
      "20_21_Anomaly": 0.67,
      "20_59_#default#": 0.2,
      "22_24_Exists": 0.45,
      "22_59_#default#": 0.16,
      "27_28_Anomaly": 0.52,
      "27_59_#default#": 0.33,
      "29_31_Anomaly": 0.68,
      "29_59_#default#": 0.12,
      "35_59_#default#": 0.38,
      "40_39_Isolate": 0.53,
      "40_42_Do not isolate": 0.28,
      "41_42_Do not disable": 0.16,
      "41_43_Disable": 0.59,
      "49_41_Remediate": 0.55,
      "49_42_#default#": 0.15,
      "55_42_#default#": 0.1,
      "59_50_#default#": 0.16,
      "63_59_#default#": 0.3,
      "66_51_#default#": 0.43,
      "8_9_yes": 0.41
    },
    "paper": {
      "dimensions": {
        "height": 3020,
        "width": 3388,
        "x": -1061,
        "y": 30
      }
    }
  }
inputs: []
outputs: []
marketplaces: ["marketplacev2", "platform"]
tests:
- No tests (auto formatted)
fromversion: 6.10.0
contentitemexportablefields:
  contentitemfields: {}
