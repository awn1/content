category: Endpoint
defaultEnabled: true
sectionOrder:
- Connect
- Collect
commonfields:
  id: Cortex Core - Platform
  version: -1
configuration:
- additionalinfo: The timeout of the HTTP requests sent to Cortex API (in seconds).
  defaultvalue: '120'
  display: HTTP Timeout
  name: timeout
  type: 0
  required: false
  section: Connect
description: This integration uses the Cortex API to access all the core services and capabilities of the Cortex platform.
display: Cortex Platform - Core
name: Cortex Core - Platform
script:
  commands:
  - arguments:
    - description: The unique ID of the issue.
      isArray: true
      name: alert_id
    - auto: PREDEFINED
      description: The severity of the issue.
      isArray: true
      name: severity
      predefined:
      - low
      - medium
      - high
    - description: "A custom filter. When using this argument, other filter arguments are not relevant. example: \n`{\n                \"OR\": [\n                    {\n                        \"SEARCH_FIELD\": \"actor_process_command_line\",\n                        \"SEARCH_TYPE\": \"EQ\",\n                        \"SEARCH_VALUE\": \"path_to_file\"\n                    }\n                ]\n            }`."
      name: custom_filter
    - auto: PREDEFINED
      description: Account type.
      isArray: true
      name: Identity_type
      predefined:
      - ANONYMOUS
      - APPLICATION
      - COMPUTE
      - FEDERATED_IDENTITY
      - SERVICE
      - SERVICE_ACCOUNT
      - TEMPORARY_CREDENTIALS
      - TOKEN
      - UNKNOWN
      - USER
    - description: A unique identifier per agent.
      isArray: true
      name: agent_id
    - description: The hostname to connect to. In case of a proxy connection, this value will differ from action_remote_ip.
      isArray: true
      name: action_external_hostname
    - description: A string identifying the user rule.
      isArray: true
      name: rule_id
    - description: The name of the user rule.
      isArray: true
      name: rule_name
    - description: The issue name.
      isArray: true
      name: alert_name
    - description: The issue source.
      isArray: true
      name: alert_source
    - auto: PREDEFINED
      description: Supports relative times or “custom” time option. If you choose the "custom" option, you should use start_time and end_time arguments.
      name: time_frame
      predefined:
      - 60 minutes
      - 3 hours
      - 12 hours
      - 24 hours
      - 2 days
      - 7 days
      - 14 days
      - 30 days
      - custom
    - description: The name assigned to the user_id during agent runtime.
      isArray: true
      name: user_name
    - description: The file name of the binary file.
      isArray: true
      name: actor_process_image_name
    - description: CGO CMD.
      isArray: true
      name: causality_actor_process_image_command_line
    - description: |-
        Trimmed to 128 unicode chars during event serialization.
        Full value reported as part of the original process event.
      isArray: true
      name: actor_process_image_command_line
    - description: The command line of the process created.
      isArray: true
      name: action_process_image_command_line
    - description: SHA256 hash of the binary file.
      isArray: true
      name: actor_process_image_sha256
    - description: SHA256 hash of the binary file.
      isArray: true
      name: causality_actor_process_image_sha256
    - description: SHA256 of the binary file.
      isArray: true
      name: action_process_image_sha256
    - description: SHA256 of the file related to the event.
      isArray: true
      name: action_file_image_sha256
    - description: The name of the registry.
      isArray: true
      name: action_registry_name
    - description: The key data of the registry.
      isArray: true
      name: action_registry_key_data
    - description: The host IP address.
      isArray: true
      name: host_ip
    - description: The local IP address for the connection.
      isArray: true
      name: action_local_ip
    - description: Remote IP address for the connection.
      isArray: true
      name: action_remote_ip
    - auto: PREDEFINED
      description: Issue action status.
      name: alert_action_status
      predefined:
      - detected
      - detected (allowed the session)
      - detected (download)
      - detected (forward)
      - detected (post detected)
      - detected (prompt allow)
      - detected (raised an alert)
      - detected (reported)
      - detected (on write)
      - detected (scanned)
      - detected (sinkhole)
      - detected (syncookie sent)
      - detected (wildfire upload failure)
      - detected (wildfire upload success)
      - detected (wildfire upload skip)
      - detected (xdr managed threat hunting)
      - prevented (block)
      - prevented (blocked)
      - prevented (block-override)
      - prevented (blocked the url)
      - prevented (blocked the ip)
      - prevented (continue)
      - prevented (denied the session)
      - prevented (dropped all packets)
      - prevented (dropped the session)
      - prevented (dropped the session and sent a tcp reset)
      - prevented (dropped the packet)
      - prevented (override)
      - prevented (override-lockout)
      - prevented (post detected)
      - prevented (prompt block)
      - prevented (random-drop)
      - prevented (silently dropped the session with an icmp unreachable message to the host or application)
      - prevented (terminated the session and sent a tcp reset to both sides of the connection)
      - prevented (terminated the session and sent a tcp reset to the client)
      - prevented (terminated the session and sent a tcp reset to the server)
      - prevented (on write)
    - description: The local IP address for the connection.
      isArray: true
      name: action_local_port
    - description: The remote port for the connection.
      isArray: true
      name: action_remote_port
    - description: The hostname connected to. In case of a proxy connection, this value will differ from action_remote_ip.
      isArray: true
      name: dst_action_external_hostname
    - defaultValue: source_insert_ts
      description: The field by which to sort the results.
      isArray: true
      name: sort_field
    - auto: PREDEFINED
      description: The order in which to sort the results.
      name: sort_order
      predefined:
      - DESC
      - ASC
    - defaultValue: '0'
      description: The first page from which we bring the issues.
      isArray: true
      name: offset
    - defaultValue: '50'
      description: The last page from which we bring the issues.
      isArray: true
      name: limit
    - description: Relevant when "time_frame" argument is "custom". Supports epoch timestamp and simplified extended ISO format (YYYY-MM-DDThh:mm:ss.000Z).
      name: start_time
    - description: Relevant when "time_frame" argument is "custom". Supports epoch timestamp and simplified extended ISO format (YYYY-MM-DDThh:mm:ss.000Z).
      name: end_time
    - auto: PREDEFINED
      description: Whether the issue is starred or not.
      name: starred
      predefined:
      - 'true'
      - 'false'
    - description: The MITRE attack technique.
      isArray: true
      name: mitre_technique_id_and_name
    - description: The category of the issue.
      isArray: true
      name: alert_category
    - description: The domain of the issue.
      isArray: true
      name: alert_domain
    - description: The description of the issue.
      isArray: true
      name: alert_description
    - description: The SHA256 hash of the OS actor process image.
      isArray: true
      name: os_actor_process_image_sha256
    - description: The SHA256 hash of the action file macro.
      isArray: true
      name: action_file_macro_sha256
    - description: The status progress.
      isArray: true
      name: status
      predefined:
        - New
        - In Progress
        - Resolved
    - description: Not status progress.
      isArray: true
      name: not_status
      predefined:
      - New
      - In Progress
      - Resolved
    description: "Returns a list of issues and their metadata, which you can filter by built-in arguments or use the custom_filter to input a JSON filter object. \nMultiple filter arguments will be concatenated using the AND operator, while arguments that support a comma-separated list of values will use an OR operator between each value."
    name: core-get-issues
    outputs:
    - contextPath: Core.Issue.internal_id
      description: The unique ID of the issue.
      type: String
    - contextPath: Core.Alert.source_insert_ts
      description: The detection timestamp.
      type: Number
    - contextPath: Core.Alert.alert_name
      description: The name of the alert.
      type: String
    - contextPath: Core.Alert.severity
      description: The severity of the alert.
      type: String
    - contextPath: Core.Alert.alert_category
      description: The category of the alert.
      type: String
    - contextPath: Core.Alert.alert_action_status
      description: |-
        The alert action. Possible values.

        DETECTED: detected
        DETECTED_0: detected (allowed the session)
        DOWNLOAD: detected (download)
        DETECTED_19: detected (forward)
        POST_DETECTED: detected (post detected)
        PROMPT_ALLOW: detected (prompt allow)
        DETECTED_4: detected (raised an alert)
        REPORTED: detected (reported)
        REPORTED_TRIGGER_4: detected (on write)
        SCANNED: detected (scanned)
        DETECTED_23: detected (sinkhole)
        DETECTED_18: detected (syncookie sent)
        DETECTED_21: detected (wildfire upload failure)
        DETECTED_20: detected (wildfire upload success)
        DETECTED_22: detected (wildfire upload skip)
        DETECTED_MTH: detected (xdr managed threat hunting)
        BLOCKED_25: prevented (block)
        BLOCKED: prevented (blocked)
        BLOCKED_14: prevented (block-override)
        BLOCKED_5: prevented (blocked the url)
        BLOCKED_6: prevented (blocked the ip)
        BLOCKED_13: prevented (continue)
        BLOCKED_1: prevented (denied the session)
        BLOCKED_8: prevented (dropped all packets)
        BLOCKED_2: prevented (dropped the session)
        BLOCKED_3: prevented (dropped the session and sent a tcp reset)
        BLOCKED_7: prevented (dropped the packet)
        BLOCKED_16: prevented (override)
        BLOCKED_15: prevented (override-lockout)
        BLOCKED_26: prevented (post detected)
        PROMPT_BLOCK: prevented (prompt block)
        BLOCKED_17: prevented (random-drop)
        BLOCKED_24: prevented (silently dropped the session with an icmp unreachable message to the host or application)
        BLOCKED_9: prevented (terminated the session and sent a tcp reset to both sides of the connection)
        BLOCKED_10: prevented (terminated the session and sent a tcp reset to the client)
        BLOCKED_11: prevented (terminated the session and sent a tcp reset to the server)
        BLOCKED_TRIGGER_4: prevented (on write).

      type: String
    - contextPath: Core.Alert.alert_action_status_readable
      description: The alert action.
      type: String
    - contextPath: Core.Alert.alert_name
      description: The alert name.
      type: String
    - contextPath: Core.Alert.alert_description
      description: The alert description.
      type: String
    - contextPath: Core.Alert.agent_ip_addresses
      description: The host IP address.
      type: String
    - contextPath: Core.Alert.agent_hostname
      description: The hostname.
      type: String
    - contextPath: Core.Alert.mitre_tactic_id_and_name
      description: The MITRE attack tactic.
      type: String
    - contextPath: Core.Alert.mitre_technique_id_and_name
      description: The MITRE attack technique.
      type: String
    - contextPath: Core.Alert.starred
      description: Whether the alert is starred or not.
      type: Boolean
  - arguments:
    - description: Asset unique identifier.
      name: asset_id
      required: true
    name: core-get-asset-details
    description: Get asset information.
    outputs:
    - contextPath: Core.CoreAsset
      description: Asset additional information.
    - contextPath: Core.CoreAsset.xdm__asset__provider
      description: The cloud provider or source responsible for the asset.
    - contextPath: Core.CoreAsset.xdm__asset__realm
      description: The realm or logical grouping of the asset.
    - contextPath: Core.CoreAsset.xdm__asset__last_observed
      description: The timestamp when the asset was last observed, in ISO 8601 format.
    - contextPath: Core.CoreAsset.xdm__asset__type__id
      description: The unique identifier for the asset type.
    - contextPath: Core.CoreAsset.xdm__asset__first_observed
      description: The timestamp when the asset was first observed, in ISO 8601 format.
    - contextPath: Core.CoreAsset.asset_hierarchy
      description: The hierarchy or structure representing the asset.
    - contextPath: Core.CoreAsset.xdm__asset__type__category
      description: The asset category type.
    - contextPath: Core.CoreAsset.xdm__cloud__region
      description: The cloud region where the asset resides.
    - contextPath: Core.CoreAsset.xdm__asset__module_unstructured_fields
      description: The unstructured fields or metadata associated with the asset module.
    - contextPath: Core.CoreAsset.xdm__asset__source
      description: The originating source of the asset's information.
    - contextPath: Core.CoreAsset.xdm__asset__id
      description: The source unique identifier for the asset.
    - contextPath: Core.CoreAsset.xdm__asset__type__class
      description: The classification or type class of the asset.
    - contextPath: Core.CoreAsset.xdm__asset__type__name
      description: The specific name of the asset type.
    - contextPath: Core.CoreAsset.xdm__asset__strong_id
      description: The strong or immutable identifier for the asset.
    - contextPath: Core.CoreAsset.xdm__asset__name
      description: The name of the asset.
    - contextPath: Core.CoreAsset.xdm__asset__raw_fields
      description: The raw fields or unprocessed data related to the asset.
    - contextPath: Core.CoreAsset.xdm__asset__normalized_fields
      description: The normalized fields associated with the asset.
    - contextPath: Core.CoreAsset.all_sources
      description: A list of all sources providing information about the asset.
  runonce: false
  script: '-'
  subtype: python3
  type: python
  dockerimage: demisto/google-cloud-storage:1.0.0.2941324
tests:
- No tests
fromversion: 6.2.0
marketplaces:
- platform
supportedModules:
- C1
- C3
- x0
- X1
- X3
- X5
- ENT_PLUS
- agentix